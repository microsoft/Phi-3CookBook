# Olive เจฆเฉ เจตเจฐเจคเฉเจ เจจเจพเจฒ Phi3 เจจเฉเฉฐ Fine-tune เจเจฐเฉ

เจเจธ เจเจฆเจพเจนเจฐเจจ เจตเจฟเฉฑเจ เจคเฉเจธเฉเจ Olive เจฆเฉ เจตเจฐเจคเฉเจ เจเจฐเจเฉ เจเจน เจเฉฐเจฎ เจเจฐเฉเจเฉ:

1. เจเฉฑเจ LoRA เจเจกเจพเจชเจเจฐ เจจเฉเฉฐ Fine-tune เจเจฐเฉ, เจเฉ เจตเจพเจเจพเจเจธเจผเจพเจ เจจเฉเฉฐ Sad, Joy, Fear, Surprise เจตเจฟเฉฑเจ เจตเจฐเจเจฌเฉฑเจง เจเจฐเฉเฅค
1. เจเจกเจพเจชเจเจฐ เจตเจเจผเจจ เจจเฉเฉฐ เจฌเฉเจธ เจฎเจพเจกเจฒ เจตเจฟเฉฑเจ เจฎเจฐเจ เจเจฐเฉเฅค
1. เจฎเจพเจกเจฒ เจจเฉเฉฐ `int4` เจตเจฟเฉฑเจ เจเจชเจเจฟเจฎเจพเจเจเจผ เจเจคเฉ เจเจตเจพเจเจเจพเจเจเจผ เจเจฐเฉเฅค

เจเจธเฉเจ เจคเฉเจนเจพเจจเฉเฉฐ เจเจน เจตเฉ เจฆเจฟเจเจพเจตเจพเจเจเฉ เจเจฟ ONNX Runtime (ORT) Generate API เจฆเฉ เจตเจฐเจคเฉเจ เจเจฐเจเฉ Fine-tuned เจฎเจพเจกเจฒ เจจเฉเฉฐ เจเจฟเจตเฉเจ เจเจจเจซเจฐเฉเจเจธ เจเจฐเจจเจพ เจนเฉเฅค

> **โ๏ธ Fine-tuning เจฒเจ, เจคเฉเจนเจพเจกเฉ เจเฉเจฒ เจเฉฑเจ เจเจเจฟเจค GPU เจเจชเจฒเจฌเจง เจนเฉเจฃเจพ เจเจพเจนเฉเจฆเจพ เจนเฉ - เจเจฆเจพเจนเจฐเจฃ เจฒเจ, A10, V100, A100เฅค**

## ๐พ เจเฉฐเจธเจเจพเจฒ เจเจฐเฉ

เจเฉฑเจ เจจเจตเฉเจ Python เจตเจฐเจเฉเจเจฒ เจเจจเจตเจพเจเจฐเจจเจฎเฉเจเจ เจฌเจฃเจพเจ (เจเจฆเจพเจนเจฐเจฃ เจฒเจ, `conda` เจฆเฉ เจตเจฐเจคเฉเจ เจเจฐเจเฉ):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

เจเจเจฒเจพ, Olive เจเจคเฉ Fine-tuning เจตเจฐเจเจซเจฒเฉ เจฒเจ เจฒเฉเฉเฉเจเจฆเฉเจเจ Dependencies เจเฉฐเจธเจเจพเจฒ เจเจฐเฉ:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ๐งช Olive เจฆเฉ เจตเจฐเจคเฉเจ เจจเจพเจฒ Phi3 เจจเฉเฉฐ Fine-tune เจเจฐเฉ
[Olive เจเจจเจซเจฟเจเจฐเฉเจธเจผเจจ เจซเจพเจเจฒ](../../../../../code/03.Finetuning/olive-ort-example/phrase-classification.json) เจตเจฟเฉฑเจ เจเฉฑเจ *เจตเจฐเจเจซเจฒเฉ* เจนเฉ, เจเจฟเจธ เจตเจฟเฉฑเจ เจเจน *เจชเจพเจธเฉ* เจธเจผเจพเจฎเจฒ เจนเจจ:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

เจเฉฑเจ-เจชเฉฑเจงเจฐเฉ เจฐเฉเจช เจตเจฟเฉฑเจ, เจเจน เจตเจฐเจเจซเจฒเฉ เจเจน เจเฉฐเจฎ เจเจฐเฉเจเจพ:

1. Phi3 เจจเฉเฉฐ Fine-tune เจเจฐเฉ (150 เจธเจเฉเจช เจฒเจ, เจเจฟเจธเจจเฉเฉฐ เจคเฉเจธเฉเจ เจฌเจฆเจฒ เจธเจเจฆเฉ เจนเฉ) [dataset/data-classification.json](../../../../../code/03.Finetuning/olive-ort-example/dataset/dataset-classification.json) เจกเจพเจเจพ เจฆเฉ เจตเจฐเจคเฉเจ เจเจฐเจเฉเฅค
1. LoRA เจเจกเจพเจชเจเจฐ เจตเจเจผเจจ เจจเฉเฉฐ เจฌเฉเจธ เจฎเจพเจกเจฒ เจตเจฟเฉฑเจ เจฎเจฐเจ เจเจฐเฉเฅค เจเจธ เจจเจพเจฒ เจคเฉเจนเจพเจจเฉเฉฐ ONNX เจซเจพเจฐเจฎเฉเจ เจตเจฟเฉฑเจ เจเฉฑเจ เจธเจฟเฉฐเจเจฒ เจฎเจพเจกเจฒ เจเจฐเจเฉเจซเฉเจเจ เจฎเจฟเจฒเฉเจเจพเฅค
1. Model Builder เจฎเจพเจกเจฒ เจจเฉเฉฐ ONNX runtime เจฒเจ เจเจชเจเจฟเจฎเจพเจเจเจผ เจเจฐเฉเจเจพ *เจเจคเฉ* เจฎเจพเจกเจฒ เจจเฉเฉฐ `int4` เจตเจฟเฉฑเจ เจเจตเจพเจเจเจพเจเจเจผ เจเจฐเฉเจเจพเฅค

เจตเจฐเจเจซเจฒเฉ เจเจฒเจพเจเจฃ เจฒเจ, เจเจน เจเจฎเจพเจเจก เจฐเจจ เจเจฐเฉ:

```bash
olive run --config phrase-classification.json
```

เจเจฆเฉเจ Olive เจฎเฉเจเฉฐเจฎเจฒ เจนเฉ เจเจพเจเจฆเจพ เจนเฉ, เจคเจพเจ เจคเฉเจนเจพเจกเจพ เจเจชเจเจฟเจฎเจพเจเจเจผ เจเฉเจคเจพ เจนเฉเจเจ `int4` Fine-tuned Phi3 เจฎเจพเจกเจฒ เจเจนเจฅเฉ เจเจชเจฒเจฌเจง เจนเฉ: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`เฅค

## ๐งโ๐ป Fine-tuned Phi3 เจจเฉเฉฐ เจเจชเจฃเฉ เจเจชเจฒเฉเจเฉเจธเจผเจจ เจตเจฟเฉฑเจ เจเฉฐเจเฉเจเฉเจฐเฉเจ เจเจฐเฉ

เจเจช เจเจฒเจพเจเจฃ เจฒเจ:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

เจเจน เจเจตเจพเจฌ เจซเจฐเฉเจเจผ เจฆเฉ เจเฉฑเจ เจธเจฟเฉฐเจเจฒ เจตเจฐเจเจฌเฉฑเจงเจคเจพ เจนเฉเจฃเฉ เจเจพเจนเฉเจฆเฉ เจนเฉ (Sad/Joy/Fear/Surprise)เฅค

**เจเจธเจตเฉเจเจฐเจจ**:  
เจเจน เจฆเจธเจคเจพเจตเฉเจเจผ เจฎเจธเจผเฉเจจ-เจเจงเจพเจฐเจฟเจค AI เจเจจเฉเจตเจพเจฆ เจธเฉเจตเจพเจตเจพเจ เจฆเฉ เจตเจฐเจคเฉเจ เจเจฐเจเฉ เจเจจเฉเจตเจพเจฆเจฟเจค เจเฉเจคเจพ เจเจฟเจ เจนเฉเฅค เจเจธเฉเจ เจธเจนเฉ เจนเฉเจฃ เจฆเจพ เจฏเจคเจจ เจเจฐเจฆเฉ เจนเจพเจ, เจชเจฐ เจเจฟเจฐเจชเจพ เจเจฐเจเฉ เจงเจฟเจเจจ เจฆเจฟเจ เจเจฟ เจเจเฉเจฎเฉเจเจฟเจ เจเจจเฉเจตเจพเจฆเจพเจ เจตเจฟเฉฑเจ เจเจฒเจคเฉเจเจ เจเจพเจ เจเจธเฉเจเฉฑเจเฉ เจชเฉฑเจ เจนเฉ เจธเจเจฆเฉ เจนเจจเฅค เจฎเฉเจฒ เจฆเจธเจคเจพเจตเฉเจเจผ, เจเฉ เจเจธเจฆเฉ เจฎเฉเจฒ เจญเจพเจธเจผเจพ เจตเจฟเฉฑเจ เจนเฉ, เจจเฉเฉฐ เจเจงเจฟเจเจพเจฐเจค เจธเจฐเฉเจค เจฎเฉฐเจจเจฟเจ เจเจพเจฃเจพ เจเจพเจนเฉเจฆเจพ เจนเฉเฅค เจฎเจนเฉฑเจคเจตเจชเฉเจฐเจจ เจเจพเจฃเจเจพเจฐเฉ เจฒเจ, เจชเฉเจธเจผเฉเจตเจฐ เจฎเจจเฉเฉฑเจเฉ เจเจจเฉเจตเจพเจฆ เจฆเฉ เจธเจฟเจซเจพเจฐเจธเจผ เจเฉเจคเฉ เจเจพเจเจฆเฉ เจนเฉเฅค เจเจธ เจเจจเฉเจตเจพเจฆ เจฆเฉ เจเจธเจคเฉเจฎเจพเจฒ เจคเฉเจ เจชเฉเจฆเจพ เจนเฉเจฃ เจตเจพเจฒเฉเจเจ เจเจฟเจธเฉ เจตเฉ เจเจฒเจค เจซเจนเจฟเจฎเฉเจเจ เจเจพเจ เจเจฒเจค เจตเจฟเจเจเจฟเจเจตเจพเจ เจฒเจ เจเจธเฉเจ เจเจผเจฟเฉฐเจฎเฉเจตเจพเจฐ เจจเจนเฉเจ เจนเจพเจเฅค