# ุถุจุท Phi3 ุจุงุณุชุฎุฏุงู Olive

ูู ูุฐุง ุงููุซุงูุ ุณุชุณุชุฎุฏู Olive ูู:

1. ุถุจุท LoRA adapter ูุชุตููู ุงูุนุจุงุฑุงุช ุฅูู ุญุฒูุ ูุฑุญุ ุฎููุ ููุงุฌุฃุฉ.
2. ุฏูุฌ ุฃูุฒุงู ุงููุญูู (adapter) ูู ุงููููุฐุฌ ุงูุฃุณุงุณู.
3. ุชุญุณูู ุงููููุฐุฌ ูุถุบุทู ุฅูู `int4`.

ุณููุถุญ ูู ุฃูุถูุง ููููุฉ ุชูููุฐ ุงุณุชุฏูุงู ุจุงุณุชุฎุฏุงู ุงููููุฐุฌ ุงููุถุจูุท ุนุจุฑ ูุงุฌูุฉ Generate API ุงูุฎุงุตุฉ ุจู ONNX Runtime (ORT).

> **โ๏ธ ูุถุจุท ุงููููุฐุฌุ ุณุชุญุชุงุฌ ุฅูู ุชููุฑ GPU ููุงุณุจ - ูุซู A10 ุฃู V100 ุฃู A100.**

## ๐พ ุงูุชุซุจูุช

ูู ุจุฅูุดุงุก ุจูุฆุฉ Python ุงูุชุฑุงุถูุฉ ุฌุฏูุฏุฉ (ุนูู ุณุจูู ุงููุซุงูุ ุจุงุณุชุฎุฏุงู `conda`):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

ุจุนุฏ ุฐููุ ูู ุจุชุซุจูุช Olive ูุงููุชุทูุจุงุช ุงููุงุฒูุฉ ูุนูููุฉ ุถุจุท ุงููููุฐุฌ:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ๐งช ุถุจุท Phi3 ุจุงุณุชุฎุฏุงู Olive

ููู [ุชูููู Olive](../../../../../code/04.Finetuning/olive-ort-example/phrase-classification.json) ูุญุชูู ุนูู *ุนูููุฉ* ูุน ุงููุฑุงุญู ุงูุชุงููุฉ:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

ุจุดูู ุนุงูุ ูุฐู ุงูุนูููุฉ ุณุชููู ุจู:

1. ุถุจุท Phi3 (ููุฏุฉ 150 ุฎุทูุฉุ ูููููู ุชุนุฏูููุง) ุจุงุณุชุฎุฏุงู ุจูุงูุงุช [dataset/data-classification.json](../../../../../code/04.Finetuning/olive-ort-example/dataset/dataset-classification.json).
2. ุฏูุฌ ุฃูุฒุงู LoRA adapter ูู ุงููููุฐุฌ ุงูุฃุณุงุณู. ุณูููุญู ูุฐุง ููู ูููุฐุฌ ูุงุญุฏ ุจุตูุบุฉ ONNX.
3. ูููู Model Builder ุจุชุญุณูู ุงููููุฐุฌ ูุชุดุบููู ุจุงุณุชุฎุฏุงู ONNX runtime *ูุฃูุถูุง* ุถุบุท ุงููููุฐุฌ ุฅูู `int4`.

ูุชูููุฐ ุงูุนูููุฉุ ูู ุจุชุดุบูู:

```bash
olive run --config phrase-classification.json
```

ุนูุฏ ุงูุชูุงู Oliveุ ุณูููู ูููุฐุฌ Phi3 ุงููุถุจูุท ูุงููุญุณู ุจุตูุบุฉ `int4` ูุชุงุญูุง ูู: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`.

## ๐งโ๐ป ุฏูุฌ Phi3 ุงููุถุจูุท ูู ุชุทุจููู

ูุชุดุบูู ุงูุชุทุจูู:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

ูุฌุจ ุฃู ุชููู ุงูุงุณุชุฌุงุจุฉ ุชุตููููุง ุจูููุฉ ูุงุญุฏุฉ ููุนุจุงุฑุฉ (ุญุฒู/ูุฑุญ/ุฎูู/ููุงุฌุฃุฉ).

**ุฅุฎูุงุก ุงููุณุคูููุฉ**:  
ุชู ุชุฑุฌูุฉ ูุฐุง ุงููุณุชูุฏ ุจุงุณุชุฎุฏุงู ุฎุฏูุงุช ุชุฑุฌูุฉ ุขููุฉ ุชุนุชูุฏ ุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู. ุนูู ุงูุฑุบู ูู ุฃููุง ูุณุนู ูุชุญููู ุงูุฏูุฉุ ูุฑุฌู ุงูุนูู ุจุฃู ุงูุชุฑุฌูุงุช ุงูุขููุฉ ูุฏ ุชุญุชูู ุนูู ุฃุฎุทุงุก ุฃู ูุนูููุงุช ุบูุฑ ุฏูููุฉ. ูุฌุจ ุงุนุชุจุงุฑ ุงููุณุชูุฏ ุงูุฃุตูู ุจูุบุชู ุงูุฃุตููุฉ ูู ุงููุตุฏุฑ ุงูุฑุณูู. ููุญุตูู ุนูู ูุนูููุงุช ุญุงุณูุฉุ ูููุตู ุจุงููุฌูุก ุฅูู ุชุฑุฌูุฉ ุจุดุฑูุฉ ุงุญุชุฑุงููุฉ. ูุญู ุบูุฑ ูุณุคูููู ุนู ุฃู ุณูุก ููู ุฃู ุชูุณูุฑุงุช ุฎุงุทุฆุฉ ูุงุชุฌุฉ ุนู ุงุณุชุฎุฏุงู ูุฐู ุงูุชุฑุฌูุฉ.