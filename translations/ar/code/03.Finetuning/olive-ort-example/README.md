# ุถุจุท Phi3 ุจุงุณุชุฎุฏุงู Olive

ูู ูุฐุง ุงููุซุงู ุณุชุณุชุฎุฏู Olive ููููุงู ุจูุง ููู:

1. ุถุจุท ูุญูู LoRA ูุชุตููู ุงูุนุจุงุฑุงุช ุฅูู ุญุฒูุ ูุฑุญุ ุฎููุ ููุงุฌุฃุฉ.
2. ุฏูุฌ ุฃูุฒุงู ุงููุญูู ูู ุงููููุฐุฌ ุงูุฃุณุงุณู.
3. ุชุญุณูู ุงููููุฐุฌ ูุชููููู ุฅูู `int4`.

ุณููุถุญ ูู ุฃูุถูุง ููููุฉ ุงุณุชุฎุฏุงู ูููุฐุฌ ุถุจุท ุงูุฃุฏุงุก ููุชูุจุค ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช Generate ุงูุฎุงุตุฉ ุจู ONNX Runtime (ORT).

> **โ๏ธ ูุถุจุท ุงูุฃุฏุงุกุ ุณุชุญุชุงุฌ ุฅูู ูุฌูุฏ ูุญุฏุฉ ูุนุงูุฌุฉ ุฑุณููุงุช (GPU) ููุงุณุจุฉ - ูุซู A10ุ V100ุ A100.**

## ๐พ ุงูุชุซุจูุช

ูู ุจุฅูุดุงุก ุจูุฆุฉ ุงูุชุฑุงุถูุฉ ุฌุฏูุฏุฉ ูู Python (ุนูู ุณุจูู ุงููุซุงูุ ุจุงุณุชุฎุฏุงู `conda`):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

ุจุนุฏ ุฐููุ ูู ุจุชุซุจูุช Olive ููุชุทูุจุงุช ุณูุฑ ุงูุนูู ูุถุจุท ุงูุฃุฏุงุก:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ๐งช ุถุจุท Phi3 ุจุงุณุชุฎุฏุงู Olive

ูุญุชูู [ููู ุฅุนุฏุงุฏ Olive](../../../../../code/03.Finetuning/olive-ort-example/phrase-classification.json) ุนูู *ุณูุฑ ุนูู* ูุน *ุฎุทูุงุช* ุชุดูู ูุง ููู:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

ุจุตูุฑุฉ ุนุงูุฉุ ูููู ูุฐุง ุณูุฑ ุงูุนูู ุจูุง ููู:

1. ุถุจุท Phi3 (ููุฏุฉ 150 ุฎุทูุฉุ ููููู ุชุนุฏูู ุฐูู) ุจุงุณุชุฎุฏุงู ุจูุงูุงุช [dataset/data-classification.json](../../../../../code/03.Finetuning/olive-ort-example/dataset/dataset-classification.json).
2. ุฏูุฌ ุฃูุฒุงู ูุญูู LoRA ูู ุงููููุฐุฌ ุงูุฃุณุงุณู. ุณุชุญุตู ุนูู ููู ูููุฐุฌ ูุงุญุฏ ุจุตูุบุฉ ONNX.
3. ูููู Model Builder ุจุชุญุณูู ุงููููุฐุฌ ูู ONNX Runtime *ูุฃูุถูุง* ุชูููู ุงููููุฐุฌ ุฅูู `int4`.

ูุชูููุฐ ุณูุฑ ุงูุนููุ ูู ุจุชุดุบูู:

```bash
olive run --config phrase-classification.json
```

ุนูุฏ ุงูุชูุงุก Oliveุ ุณูููู ูุฏูู ูููุฐุฌ Phi3 ูุถุจูุท ููุญุณู ุจู `int4` ูู ุงููุณุงุฑ: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`.

## ๐งโ๐ป ุฏูุฌ Phi3 ุงููุถุจูุท ูู ุชุทุจููู

ูุชุดุบูู ุงูุชุทุจูู:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

ูุฌุจ ุฃู ุชููู ุงูุงุณุชุฌุงุจุฉ ูููุฉ ูุงุญุฏุฉ ุชุตูู ุงูุนุจุงุฑุฉ (ุญุฒู/ูุฑุญ/ุฎูู/ููุงุฌุฃุฉ).

**ุฅุฎูุงุก ุงููุณุคูููุฉ**:  
ุชู ุชุฑุฌูุฉ ูุฐุง ุงููุณุชูุฏ ุจุงุณุชุฎุฏุงู ุฎุฏูุงุช ุชุฑุฌูุฉ ุขููุฉ ุชุนุชูุฏ ุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู. ุจูููุง ูุณุนู ูุชุญููู ุงูุฏูุฉุ ูุฑุฌู ุงูุนูู ุฃู ุงูุชุฑุฌูุงุช ุงูุขููุฉ ูุฏ ุชุญุชูู ุนูู ุฃุฎุทุงุก ุฃู ูุนูููุงุช ุบูุฑ ุฏูููุฉ. ูุฌุจ ุงุนุชุจุงุฑ ุงููุณุชูุฏ ุงูุฃุตูู ุจูุบุชู ุงูุฃุตููุฉ ูู ุงููุตุฏุฑ ุงูููุซูู. ููุญุตูู ุนูู ูุนูููุงุช ุญุณุงุณุฉ ุฃู ูููุฉุ ูููุตู ุจุงูุงุณุชุนุงูุฉ ุจุชุฑุฌูุฉ ุจุดุฑูุฉ ุงุญุชุฑุงููุฉ. ูุญู ุบูุฑ ูุณุคูููู ุนู ุฃู ุณูุก ููู ุฃู ุชูุณูุฑ ุฎุงุทุฆ ููุดุฃ ุนู ุงุณุชุฎุฏุงู ูุฐู ุงูุชุฑุฌูุฉ.