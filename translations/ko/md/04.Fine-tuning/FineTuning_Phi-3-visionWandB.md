# Phi-3-Vision-128K-Instruct 프로젝트 개요

## 모델

Phi-3-Vision-128K-Instruct는 이 프로젝트의 핵심인 경량의 최첨단 멀티모달 모델입니다. Phi-3 모델 계열의 일부로, 최대 128,000 토큰의 컨텍스트 길이를 지원합니다. 이 모델은 합성 데이터와 신중히 필터링된 공개 웹사이트를 포함한 다양한 데이터셋을 기반으로 훈련되었으며, 고품질의 논리적 콘텐츠에 중점을 두고 있습니다. 훈련 과정에는 지시 사항을 정확하게 준수하고 강력한 안전 조치를 보장하기 위해 감독된 미세 조정과 직접 선호도 최적화가 포함되었습니다.

## 샘플 데이터를 만드는 것이 중요한 이유:

1. **테스트**: 샘플 데이터는 실제 데이터를 영향을 미치지 않고 다양한 시나리오에서 애플리케이션을 테스트할 수 있게 해줍니다. 이는 특히 개발 및 스테이징 단계에서 중요합니다.

2. **성능 조정**: 실제 데이터의 규모와 복잡성을 모방한 샘플 데이터를 사용하면 성능 병목 현상을 식별하고 애플리케이션을 최적화할 수 있습니다.

3. **프로토타이핑**: 샘플 데이터는 프로토타입과 목업을 만드는 데 사용될 수 있으며, 이는 사용자 요구 사항을 이해하고 피드백을 받는 데 도움이 됩니다.

4. **데이터 분석**: 데이터 과학에서는 샘플 데이터가 탐색적 데이터 분석, 모델 훈련 및 알고리즘 테스트에 자주 사용됩니다.

5. **보안**: 개발 및 테스트 환경에서 샘플 데이터를 사용하면 민감한 실제 데이터의 우발적인 유출을 방지할 수 있습니다.

6. **학습**: 새로운 기술이나 도구를 배우는 경우, 샘플 데이터를 사용하는 것이 배운 내용을 실용적으로 적용하는 데 도움이 될 수 있습니다.

샘플 데이터의 품질은 이러한 활동에 상당한 영향을 미칠 수 있습니다. 구조와 변동성 측면에서 실제 데이터에 최대한 가깝게 만들어야 합니다.

### 샘플 데이터 생성
[데이터셋 생성 스크립트](./CreatingSampleData.md)

## 데이터셋

샘플 데이터셋의 좋은 예로는 [DBQ/Burberry.Product.prices.United.States 데이터셋](https://huggingface.co/datasets/DBQ/Burberry.Product.prices.United.States) (Huggingface에서 이용 가능)이 있습니다. Burberry 제품의 샘플 데이터셋은 제품 카테고리, 가격, 제목 등의 메타데이터와 함께 총 3,040개의 행으로 구성되어 있으며, 각 행은 고유한 제품을 나타냅니다. 이 데이터셋은 모델이 시각 데이터를 이해하고 해석하는 능력을 테스트할 수 있게 해주며, 세밀한 시각적 세부 사항과 브랜드 특성을 포착하는 설명 텍스트를 생성합니다.

**Note:** 이미지를 포함하는 어떤 데이터셋도 사용할 수 있습니다.

## 복잡한 추론

모델은 이미지로만 제공된 가격과 이름을 추론해야 합니다. 이는 모델이 시각적 특징을 인식할 뿐만 아니라 제품 가치와 브랜딩 측면에서 그 의미를 이해해야 함을 요구합니다. 이미지를 통해 정확한 텍스트 설명을 생성함으로써, 이 프로젝트는 시각 데이터를 통합하여 실제 응용 프로그램에서 모델의 성능과 다용성을 향상시킬 수 있는 가능성을 강조합니다.

## Phi-3 Vision 아키텍처

모델 아키텍처는 Phi-3의 멀티모달 버전입니다. 텍스트와 이미지 데이터를 모두 처리하며, 이러한 입력을 통합된 시퀀스로 통합하여 포괄적인 이해 및 생성 작업을 수행합니다. 모델은 텍스트와 이미지를 위한 별도의 임베딩 레이어를 사용합니다. 텍스트 토큰은 밀집 벡터로 변환되고, 이미지는 CLIP 비전 모델을 통해 특징 임베딩을 추출합니다. 이러한 이미지 임베딩은 텍스트 임베딩의 차원에 맞게 투영되어 원활하게 통합될 수 있습니다.

## 텍스트와 이미지 임베딩의 통합

텍스트 시퀀스 내의 특수 토큰은 이미지 임베딩이 삽입되어야 하는 위치를 나타냅니다. 처리 중에 이러한 특수 토큰은 해당 이미지 임베딩으로 대체되어 모델이 텍스트와 이미지를 단일 시퀀스로 처리할 수 있게 합니다. 데이터셋의 프롬프트는 다음과 같이 특수 <|image|> 토큰을 사용하여 형식화됩니다:

```python
text = f"<|user|>\n<|image_1|>What is shown in this image?<|end|><|assistant|>\nProduct: {row['title']}, Category: {row['category3_code']}, Full Price: {row['full_price']}<|end|>"
```

## 샘플 코드
- [Phi-3-Vision 훈련 스크립트](../../../../code/04.Finetuning/Phi-3-vision-Trainingscript.py)
- [Weights and Bias Example walkthrough](https://wandb.ai/byyoung3/mlnews3/reports/How-to-fine-tune-Phi-3-vision-on-a-custom-dataset--Vmlldzo4MTEzMTg3)

**면책 조항**:
이 문서는 기계 기반 AI 번역 서비스를 사용하여 번역되었습니다. 정확성을 위해 노력하지만, 자동 번역에는 오류나 부정확성이 있을 수 있음을 유의하시기 바랍니다. 원본 문서가 권위 있는 자료로 간주되어야 합니다. 중요한 정보에 대해서는 전문 인간 번역을 권장합니다. 이 번역 사용으로 인한 오해나 잘못된 해석에 대해 당사는 책임을 지지 않습니다.