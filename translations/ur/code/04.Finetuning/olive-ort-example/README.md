# ุงููู ฺฉ ุฐุฑุน Phi3 ฺฉู ูุงุฆู ูนูู ฺฉุฑฺบ

ุงุณ ูุซุงู ูฺบ ุขูพ ุงููู ฺฉุง ุงุณุชุนูุงู ฺฉุฑฺบ ฺฏ ุชุงฺฉ:

1. LoRA ุงฺุงูพูนุฑ ฺฉู ูุงุฆู ูนูู ฺฉุฑฺบ ุชุงฺฉ ุฌูููฺบ ฺฉู Sadุ Joyุ Fearุ Surprise ูฺบ ุชูุณู ฺฉุง ุฌุง ุณฺฉ
1. ุงฺุงูพูนุฑ ฺฉ ูุฒู ฺฉู ุจุณ ูุงฺู ูฺบ ุถู ฺฉุฑฺบ
1. ูุงฺู ฺฉู `int4` ูฺบ ุจุชุฑ ุงูุฑ ฺฉูุงููนุงุฆุฒ ฺฉุฑฺบ

ู ุขูพ ฺฉู  ุจฺพ ุฏฺฉฺพุงุฆฺบ ฺฏ ฺฉ ONNX Runtime (ORT) Generate API ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ูุงุฆู ูนูู ฺฉ ฺฏุฆ ูุงฺู ูพุฑ ฺฉุณ ุทุฑุญ ุงููุฑูุณ ฺฉุฑฺบ

> **โ๏ธ ูุงุฆู ูนูููฺฏ ฺฉ ูุ ุขูพ ฺฉ ูพุงุณ ุงฺฉ ููุงุณุจ GPU ุฏุณุชุงุจ ููุง ุถุฑูุฑ  - ุฌุณ ฺฉ A10ุ V100ุ A100**

## ๐พ ุงูุณูนุงู ฺฉุฑฺบ

ุงฺฉ ูุง ูพุงุฆุชฺพู ูุฑฺูุฆู ูุงุญูู ุจูุงุฆฺบ (ูุซุงู ฺฉ ุทูุฑ ูพุฑุ `conda` ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

ุงุณ ฺฉ ุจุนุฏุ ุงููู ุงูุฑ ูุงุฆู ูนูููฺฏ ูุฑฺฉ ููู ฺฉ ู ุถุฑูุฑ ุงูุญุตุงุฑุงุช ุงูุณูนุงู ฺฉุฑฺบ:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ๐งช ุงููู ฺฉ ุฐุฑุน Phi3 ฺฉู ูุงุฆู ูนูู ฺฉุฑฺบ
[ุงููู ฺฉููฺฏุฑุดู ูุงุฆู](../../../../../code/04.Finetuning/olive-ort-example/phrase-classification.json) ูฺบ ุงฺฉ *ูุฑฺฉ ููู* ููุฌูุฏ  ุฌุณ ูฺบ ุฏุฑุฌ ุฐู *ูพุงุณุฒ* ุดุงูู ฺบ:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

ุงุนู ุณุทุญ ูพุฑุ  ูุฑฺฉ ููู ุฏุฑุฌ ุฐู ฺฉุงู ฺฉุฑ ฺฏุง:

1. Phi3 ฺฉู ูุงุฆู ูนูู ฺฉุฑฺบ (150 ูุฑุงุญู ฺฉ ูุ ุฌุณ ุขูพ ุชุจุฏู ฺฉุฑ ุณฺฉุช ฺบ) [dataset/data-classification.json](../../../../../code/04.Finetuning/olive-ort-example/dataset/dataset-classification.json) ฺูนุง ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ
1. LoRA ุงฺุงูพูนุฑ ฺฉ ูุฒู ฺฉู ุจุณ ูุงฺู ูฺบ ุถู ฺฉุฑฺบ ุงุณ ฺฉ ูุชุฌ ูฺบ ุขูพ ฺฉู ONNX ูุงุฑููน ูฺบ ุงฺฉ ูุงุญุฏ ูุงฺู ุขุฑูนูฺฉูน ูู ฺฏุง
1. ูุงฺู ุจูฺุฑ ูุงฺู ฺฉู ONNX ุฑู ูนุงุฆู ฺฉ ู ุจุชุฑ ุจูุงุฆ ฺฏุง *ุงูุฑ* ูุงฺู ฺฉู `int4` ูฺบ ฺฉูุงููนุงุฆุฒ ฺฉุฑ ฺฏุง

ูุฑฺฉ ููู ฺฉู ฺูุงู ฺฉ ู:

```bash
olive run --config phrase-classification.json
```

ุฌุจ ุงููู ูฺฉูู ู ุฌุงุฆุ ุชู ุขูพ ฺฉุง ุจุชุฑ `int4` ูุงุฆู ูนูู ฺฉุง ูุง Phi3 ูุงฺู ุงฺบ ุฏุณุชุงุจ ูฺฏุง: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`

## ๐งโ๐ป ุงูพู ุงูพู ฺฉุดู ูฺบ ูุงุฆู ูนูู ฺฉุง ูุง Phi3 ุถู ฺฉุฑฺบ 

ุงูพ ฺูุงู ฺฉ ู:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

 ุฌูุงุจ ุฌูู ฺฉ ุงฺฉ ูุงุญุฏ ููุธ ฺฉ ุฏุฑุฌ ุจูุฏ ููุง ฺุง (Sad/Joy/Fear/Surprise)

**ฺุณฺฉููุฑ**:  
 ุฏุณุชุงูุฒ ูุดู ูพุฑ ูุจู AI ุชุฑุฌู ุณุฑูุณุฒ ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ุชุฑุฌู ฺฉ ฺฏุฆ  ุงฺฏุฑฺ ู ุฏุฑุณุชฺฏ ฺฉ ู ฺฉูุดุด ฺฉุฑุช ฺบุ ุจุฑุง ฺฉุฑู ุขฺฏุง ุฑฺบ ฺฉ ุฎูุฏฺฉุงุฑ ุชุฑุฌู ูฺบ ุบูุทุงฺบ ุง ุบุฑ ุฏุฑุณุชุงฺบ ู ุณฺฉุช ฺบ ุงุตู ุฏุณุชุงูุฒ ฺฉู ุงุณ ฺฉ ุงุตู ุฒุจุงู ูฺบ ูุณุชูุฏ ุฐุฑุน ุณูุฌฺพุง ุฌุงูุง ฺุง ุงู ูุนูููุงุช ฺฉ ูุ ูพุด ูุฑ ุงูุณุงู ุชุฑุฌู ฺฉ ุณูุงุฑุด ฺฉ ุฌุงุช  ู ุงุณ ุชุฑุฌู ฺฉ ุงุณุชุนูุงู ุณ ูพุฏุง ูู ูุงู ฺฉุณ ุจฺพ ุบูุท ูู ุง ุบูุท ุชุดุฑุญ ฺฉ ุฐู ุฏุงุฑ ูฺบ ฺบ