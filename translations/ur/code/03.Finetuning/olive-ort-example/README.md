# ุงููู ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ Phi3 ฺฉู ูุงุฆู ูนูู ฺฉุฑฺบ

ุงุณ ูุซุงู ูฺบ ุขูพ ุงููู ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ:

1. LoRA ุงฺุงูพูนุฑ ฺฉู ูุงุฆู ูนูู ฺฉุฑฺบ ฺฏ ุชุงฺฉ ุฌูููฺบ ฺฉู Sad, Joy, Fear, Surprise ูฺบ ุชูุณู ฺฉุง ุฌุง ุณฺฉ
2. ุงฺุงูพูนุฑ ููนุณ ฺฉู ุจุณ ูุงฺู ูฺบ ุถู ฺฉุฑฺบ ฺฏ
3. ูุงฺู ฺฉู `int4` ูฺบ ุขูพูนูุงุฆุฒ ุงูุฑ ฺฉูุงููนุงุฆุฒ ฺฉุฑฺบ ฺฏ

ู ุขูพ ฺฉู  ุจฺพ ุฏฺฉฺพุงุฆฺบ ฺฏ ฺฉ ฺฉุณ ุทุฑุญ ูุงุฆู ูนูู ุดุฏ ูุงฺู ฺฉู ONNX Runtime (ORT) Generate API ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ุงููุฑูุณ ฺฉุฑฺบ

> **โ๏ธ ูุงุฆู ูนูููฺฏ ฺฉ ูุ ุขูพ ฺฉ ูพุงุณ ุงฺฉ ููุงุณุจ GPU ููุง ุถุฑูุฑ  - ูุซุงู ฺฉ ุทูุฑ ูพุฑุ A10, V100, A100**

## ๐พ ุงูุณูนุงู ฺฉุฑฺบ

ุงฺฉ ูุง Python ูุฑฺูุฆู ูุงุญูู ุจูุงุฆฺบ (ูุซุงู ฺฉ ุทูุฑ ูพุฑุ `conda` ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ):

```bash
conda create -n olive-ai python=3.11
conda activate olive-ai
```

ูพฺพุฑุ ุงููู ุงูุฑ ูุงุฆู ูนูููฺฏ ูุฑฺฉ ููู ฺฉ ู ุถุฑูุฑ ฺูพูฺูุณุฒ ุงูุณูนุงู ฺฉุฑฺบ:

```bash
cd Phi-3CookBook/code/04.Finetuning/olive-ort-example
pip install olive-ai[gpu]
pip install -r requirements.txt
```

## ๐งช ุงููู ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ Phi3 ฺฉู ูุงุฆู ูนูู ฺฉุฑฺบ
[ุงููู ฺฉููฺฏุฑุดู ูุงุฆู](../../../../../code/03.Finetuning/olive-ort-example/phrase-classification.json) ุงฺฉ *ูุฑฺฉ ููู* ูพุฑ ูุดุชูู  ุฌุณ ูฺบ ุฏุฑุฌ ุฐู *ูพุงุณุฒ* ุดุงูู ฺบ:

Phi3 -> LoRA -> MergeAdapterWeights -> ModelBuilder

ุงุนู ุณุทุญ ูพุฑุ  ูุฑฺฉ ููู ุฏุฑุฌ ุฐู ฺฉุฑ ฺฏุง:

1. Phi3 ฺฉู [dataset/data-classification.json](../../../../../code/03.Finetuning/olive-ort-example/dataset/dataset-classification.json) ฺูนุง ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ 150 ูุฑุงุญู ฺฉ ู (ุฌุณ ุขูพ ุชุจุฏู ฺฉุฑ ุณฺฉุช ฺบ) ูุงุฆู ูนูู ฺฉุฑ ฺฏุง
2. LoRA ุงฺุงูพูนุฑ ููนุณ ฺฉู ุจุณ ูุงฺู ูฺบ ุถู ฺฉุฑ ฺฏุง ุงุณ ุณ ุขูพ ฺฉู ONNX ูุงุฑููน ูฺบ ุงฺฉ ูุงุญุฏ ูุงฺู ุขุฑูนูฺฉูน ูู ฺฏุง
3. ูุงฺู ุจูฺุฑ ูุงฺู ฺฉู ONNX ุฑู ูนุงุฆู ฺฉ ู ุขูพูนูุงุฆุฒ ฺฉุฑ ฺฏุง *ุงูุฑ* ูุงฺู ฺฉู `int4` ูฺบ ฺฉูุงููนุงุฆุฒ ฺฉุฑ ฺฏุง

ูุฑฺฉ ููู ฺูุงู ฺฉ ู:

```bash
olive run --config phrase-classification.json
```

ุฌุจ ุงููู ูฺฉูู ู ุฌุงุฆุ ุชู ุขูพ ฺฉุง ุขูพูนูุงุฆุฒฺ `int4` ูุงุฆู ูนูู ุดุฏ Phi3 ูุงฺู ุงฺบ ุฏุณุชุงุจ ูฺฏุง: `code/04.Finetuning/olive-ort-example/models/lora-merge-mb/gpu-cuda_model`

## ๐งโ๐ป ุงูพู ุงูพู ฺฉุดู ูฺบ ูุงุฆู ูนูู ุดุฏ Phi3 ฺฉู ุดุงูู ฺฉุฑฺบ 

ุงูพ ฺูุงู ฺฉ ู:

```bash
python app/app.py --phrase "cricket is a wonderful sport!" --model-path models/lora-merge-mb/gpu-cuda_model
```

 ุฑุณูพุงูุณ ุฌูู ฺฉ ุงฺฉ ูุงุญุฏ ููุธ ุฏุฑุฌ ุจูุฏ ูู ฺุง (Sad/Joy/Fear/Surprise)

**ุงุนูุงูู ูุงุชุนูู**:  
 ุฏุณุชุงูุฒ ูุดู ูพุฑ ูุจู AI ุชุฑุฌู ุฎุฏูุงุช ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ุชุฑุฌู ฺฉ ฺฏุฆ  ุงฺฏุฑฺ ู ุฏุฑุณุชฺฏ ฺฉ ู ฺฉูุดุด ฺฉุฑุช ฺบุ ุจุฑุง ฺฉุฑู ุขฺฏุง ุฑฺบ ฺฉ ุฎูุฏฺฉุงุฑ ุชุฑุฌู ูฺบ ุบูุทุงฺบ ุง ุฎุงูุงฺบ ู ุณฺฉุช ฺบ ุงุตู ุฏุณุชุงูุฒ ฺฉู ุงุณ ฺฉ ููุงู ุฒุจุงู ูฺบ ูุณุชูุฏ ูุงุฎุฐ ุณูุฌฺพุง ุฌุงูุง ฺุง ุงู ูุนูููุงุช ฺฉ ูุ ูพุด ูุฑุงู ุงูุณุงู ุชุฑุฌู ฺฉ ุณูุงุฑุด ฺฉ ุฌุงุช  ู ุงุณ ุชุฑุฌู ฺฉ ุงุณุชุนูุงู ุณ ูพุฏุง ูู ูุงู ฺฉุณ ุจฺพ ุบูุท ูู ุง ุบูุท ุชุดุฑุญ ฺฉ ุฐู ุฏุงุฑ ูฺบ ฺบ